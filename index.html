<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Forecast Dashboard - Buses Hualp√©n</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

<header>
    <div class="header-content">
        <div class="logo">üöå Buses Hualp√©n</div>
        <div class="header-subtitle">Sistema de Gesti√≥n de Forecast</div>
    </div>
</header>

<div class="container">
    
    <div class="title">
        <span class="path">Dashboard / Forecast</span>
        <h1>Panel de Control de Inventario</h1>
    </div>

    <!-- KPIs PRINCIPALES -->
    <div class="kpi-container">
        <div class="kpi-card">
            <div class="kpi-icon">üìä</div>
            <div class="kpi-content">
                <div class="kpi-label">Desviaci√≥n Promedio</div>
                <div class="kpi-value" id="kpiDesviacion">-33.3%</div>
            </div>
        </div>
        <div class="kpi-card">
            <div class="kpi-icon">üí∞</div>
            <div class="kpi-content">
                <div class="kpi-label">Costo Total Productos</div>
                <div class="kpi-value" id="kpiCostoTotal">$11.8M</div>
            </div>
        </div>
        <div class="kpi-card">
            <div class="kpi-icon">‚úÖ</div>
            <div class="kpi-content">
                <div class="kpi-label">Cumplimiento Proveedores</div>
                <div class="kpi-value" id="kpiCumplimiento">79%</div>
            </div>
        </div>
        <div class="kpi-card">
            <div class="kpi-icon">‚ö†Ô∏è</div>
            <div class="kpi-content">
                <div class="kpi-label">Items Cr√≠ticos</div>
                <div class="kpi-value" id="kpiCriticos">4</div>
            </div>
        </div>
    </div>

    <!-- MEN√ö DESPLEGABLE DE GR√ÅFICOS -->
    <div class="chart-selector">
        <label for="chartSelect">üìà Seleccionar gr√°fico:</label>
        <select id="chartSelect">
            <option value="forecast">Forecast vs Real</option>
            <option value="desviacion">Desviaciones</option>
            <option value="costos">Costos por producto</option>
            <option value="proveedor">Cumplimiento proveedor</option>
        </select>
    </div>

    <!-- GR√ÅFICOS (solo uno visible a la vez) -->
    
    <!-- GR√ÅFICO 1: Forecast vs Real -->
    <div id="forecastCard" class="chart-card">
        <div class="chart-header">
            <h3 class="chart-title">Forecast vs Demanda Real</h3>
            <div class="period-selector">
                <button class="period-btn" data-period="dia">üìÖ D√≠a</button>
                <button class="period-btn active" data-period="semana">üìÜ Semana</button>
                <button class="period-btn" data-period="mes">üóìÔ∏è Mes</button>
            </div>
        </div>
        <canvas id="forecastChart" height="80"></canvas>
    </div>

    <!-- GR√ÅFICO 2: Desviaciones -->
    <div id="desviacionCard" class="chart-card hidden">
        <div class="chart-header">
            <h3 class="chart-title">Desviaciones Porcentuales</h3>
            <div class="period-selector">
                <button class="period-btn-desv" data-period="dia">üìÖ D√≠a</button>
                <button class="period-btn-desv" data-period="semana">üìÜ Semana</button>
                <button class="period-btn-desv active" data-period="mes">üóìÔ∏è Mes</button>
            </div>
        </div>
        <canvas id="desviacionChart" height="80"></canvas>
    </div>

    <!-- GR√ÅFICO 3: Costos -->
    <div id="costosCard" class="chart-card hidden">
        <h3 class="chart-title">Costos por Producto</h3>
        <canvas id="costosChart" height="80"></canvas>
    </div>

    <!-- GR√ÅFICO 4: Proveedores -->
    <div id="proveedorCard" class="chart-card hidden">
        <h3 class="chart-title">Cumplimiento de Proveedores</h3>
        <canvas id="proveedorChart" height="80"></canvas>
    </div>

    <!-- CUADRO √öNICO CON CARRUSEL DE INSIGHTS -->
    <div id="insightsCard" class="info-card insights-card">
        <div class="carousel-header">
            <h3>üí° An√°lisis del estado actual</h3>
            <div class="carousel-controls">
                <button class="carousel-btn" id="prevBtn">‚Äπ</button>
                <div class="carousel-dots" id="carouselDots"></div>
                <button class="carousel-btn" id="nextBtn">‚Ä∫</button>
            </div>
        </div>
        
        <div class="insights-wrapper">
            <div class="insights-inner">
                
                <!-- Slide 1: Alertas -->
                <div class="insight-slide">
                    <div class="insight-header">üö® Alertas del forecast</div>
                    <div class="insight-content collapsed" id="alertContent">
                        <p id="alertText">Cargando alertas...</p>
                    </div>
                    <button class="show-more-btn" id="alertShowMore">Mostrar m√°s ‚ñº</button>
                </div>

                <!-- Slide 2: Causa probable -->
                <div class="insight-slide">
                    <div class="insight-header">üîç Causa probable</div>
                    <div class="insight-content collapsed" id="causaContent">
                        <p id="causaText">Analizando posibles causas...</p>
                    </div>
                    <button class="show-more-btn" id="causaShowMore">Mostrar m√°s ‚ñº</button>
                </div>

                <!-- Slide 3: Recomendaci√≥n -->
                <div class="insight-slide">
                    <div class="insight-header">üí° Recomendaci√≥n autom√°tica</div>
                    <div class="insight-content collapsed" id="recomendacionContent">
                        <p id="recomendacionText">Calculando recomendaci√≥n...</p>
                    </div>
                    <button class="show-more-btn" id="recomendacionShowMore">Mostrar m√°s ‚ñº</button>
                </div>

                <!-- Slide 4: Ranking y costo -->
                <div class="insight-slide">
                    <div class="insight-header">üèÜ Ranking y costo estimado</div>
                    <div class="insight-content collapsed" id="rankingContent">
                        <p><strong>Productos con mayor costo:</strong></p>
                        <ul id="rankingList"></ul>
                        <p id="costoText"></p>
                    </div>
                    <button class="show-more-btn" id="rankingShowMore">Mostrar m√°s ‚ñº</button>
                </div>

            </div>
        </div>
    </div>

    <!-- PANEL DE SIMULADOR (separado del carrusel) -->
    <div id="simuladorCard" class="info-card">
        <h3>üéÆ Simulador de ajuste de forecast</h3>
        <div class="simulator-content">
            <div class="slider-container">
                <label>Ajuste actual: <span id="ajusteValor" class="ajuste-value">0%</span></label>
                <input type="range" id="ajusteSlider" min="-30" max="30" value="0">
                <div class="slider-labels">
                    <span>-30%</span>
                    <span>0%</span>
                    <span>+30%</span>
                </div>
            </div>
            <p class="simu-nota">üí° Mueve el deslizador para ver c√≥mo cambiar√≠a el forecast ajustado en tiempo real.</p>
        </div>
    </div>

    <!-- SELECTOR DE TABLAS (SOLO PARA LAS TABLAS) -->
    <div class="table-selector">
        <label for="tableSelect">üìã Seleccionar tabla:</label>
        <select id="tableSelect">
            <option value="tablaComparacion">Comparaci√≥n de demanda</option>
            <option value="tablaProveedores">Pedidos por proveedor</option>
            <option value="tablaInventario">Inventario de piezas</option>
        </select>
    </div>

    <!-- TABLA 1: Comparaci√≥n Forecast vs Real -->
    <table id="tablaComparacion" class="forecast-table">
        <thead>
            <tr>
                <th>Per√≠odo</th>
                <th>Esperado</th>
                <th>Demandado</th>
                <th>En Inventario</th>
                <th>Pedido Sugerido</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><strong>Mes actual</strong></td>
                <td>120</td>
                <td>80</td>
                <td><span class="badge red">Bajo</span></td>
                <td>100</td>
            </tr>
            <tr>
                <td><strong>Mes 11</strong></td>
                <td>90</td>
                <td>30</td>
                <td><span class="badge yellow">Medio</span></td>
                <td>60</td>
            </tr>
            <tr>
                <td><strong>Mes 10</strong></td>
                <td>60</td>
                <td>20</td>
                <td><span class="badge green">√ìptimo</span></td>
                <td>40</td>
            </tr>
            <tr>
                <td><strong>Mes 9</strong></td>
                <td>30</td>
                <td>40</td>
                <td><span class="badge red">Bajo</span></td>
                <td>40</td>
            </tr>
            <tr>
                <td><strong>Mes 8</strong></td>
                <td>70</td>
                <td>90</td>
                <td><span class="badge red">Bajo</span></td>
                <td>20</td>
            </tr>
            <tr>
                <td><strong>Mes 7</strong></td>
                <td>60</td>
                <td>20</td>
                <td><span class="badge green">√ìptimo</span></td>
                <td>40</td>
            </tr>
            <tr>
                <td><strong>Mes 6</strong></td>
                <td>25</td>
                <td>20</td>
                <td><span class="badge yellow">Medio</span></td>
                <td>5</td>
            </tr>
            <tr>
                <td><strong>Mes 5</strong></td>
                <td>70</td>
                <td>66</td>
                <td><span class="badge green">√ìptimo</span></td>
                <td>4</td>
            </tr>
            <tr>
                <td><strong>Mes 4</strong></td>
                <td>60</td>
                <td>20</td>
                <td><span class="badge yellow">Medio</span></td>
                <td>40</td>
            </tr>
            <tr>
                <td><strong>Mes 3</strong></td>
                <td>60</td>
                <td>20</td>
                <td><span class="badge yellow">Medio</span></td>
                <td>40</td>
            </tr>
            <tr>
                <td><strong>Mes 2</strong></td>
                <td>45</td>
                <td>60</td>
                <td><span class="badge green">√ìptimo</span></td>
                <td>12</td>
            </tr>
            <tr>
                <td><strong>Mes 1</strong></td>
                <td>60</td>
                <td>20</td>
                <td><span class="badge yellow">Medio</span></td>
                <td>40</td>
            </tr>
        </tbody>
    </table>

    <!-- TABLA 2: Pedidos por proveedor -->
    <table id="tablaProveedores" class="forecast-table hidden">
        <thead>
            <tr>
                <th>Proveedor</th>
                <th>Pedido solicitado</th>
                <th>Entregado</th>
                <th>Retraso</th>
                <th>Cumplimiento</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><strong>TransDiesel Chile</strong></td>
                <td>150</td>
                <td>140</td>
                <td>2 d√≠as</td>
                <td><span class="badge yellow">93%</span></td>
            </tr>
            <tr>
                <td><strong>MaqParts S.A.</strong></td>
                <td>200</td>
                <td>200</td>
                <td>0 d√≠as</td>
                <td><span class="badge green">100%</span></td>
            </tr>
            <tr>
                <td><strong>Repuestos del Sur Ltda.</strong></td>
                <td>90</td>
                <td>70</td>
                <td>4 d√≠as</td>
                <td><span class="badge red">78%</span></td>
            </tr>
        </tbody>
    </table>

    <!-- TABLA 3: Inventario de piezas -->
    <table id="tablaInventario" class="forecast-table hidden">
        <thead>
            <tr>
                <th>Pieza</th>
                <th>Stock actual</th>
                <th>Stock m√≠nimo</th>
                <th>Estado</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Filtros (aire, aceite, combustible)</td>
                <td>45</td>
                <td>30</td>
                <td><span class="badge green">√ìptimo</span></td>
            </tr>
            <tr>
                <td>Pastillas de freno / zapatas</td>
                <td>20</td>
                <td>25</td>
                <td><span class="badge red">Bajo</span></td>
            </tr>
            <tr>
                <td>Discos o tambores de freno</td>
                <td>12</td>
                <td>10</td>
                <td><span class="badge green">√ìptimo</span></td>
            </tr>
            <tr>
                <td>Neum√°ticos</td>
                <td>8</td>
                <td>12</td>
                <td><span class="badge yellow">Medio</span></td>
            </tr>
            <tr>
                <td>Bater√≠a</td>
                <td>15</td>
                <td>10</td>
                <td><span class="badge green">√ìptimo</span></td>
            </tr>
            <tr>
                <td>Alternador</td>
                <td>6</td>
                <td>6</td>
                <td><span class="badge yellow">Justo</span></td>
            </tr>
            <tr>
                <td>Motor de arranque</td>
                <td>4</td>
                <td>6</td>
                <td><span class="badge red">Cr√≠tico</span></td>
            </tr>
            <tr>
                <td>Correas (alternador, A/C, bomba de agua)</td>
                <td>30</td>
                <td>25</td>
                <td><span class="badge green">√ìptimo</span></td>
            </tr>
            <tr>
                <td>Amortiguadores</td>
                <td>18</td>
                <td>15</td>
                <td><span class="badge green">√ìptimo</span></td>
            </tr>
            <tr>
                <td>Bolsas de aire (suspensi√≥n)</td>
                <td>5</td>
                <td>10</td>
                <td><span class="badge red">Bajo</span></td>
            </tr>
            <tr>
                <td>Mangueras de freno o aire</td>
                <td>22</td>
                <td>20</td>
                <td><span class="badge green">√ìptimo</span></td>
            </tr>
            <tr>
                <td>Compresor de aire</td>
                <td>3</td>
                <td>5</td>
                <td><span class="badge red">Cr√≠tico</span></td>
            </tr>
            <tr>
                <td>Bomba de combustible</td>
                <td>9</td>
                <td>8</td>
                <td><span class="badge green">√ìptimo</span></td>
            </tr>
            <tr>
                <td>Inyectores</td>
                <td>7</td>
                <td>5</td>
                <td><span class="badge green">√ìptimo</span></td>
            </tr>
            <tr>
                <td>Puertas autom√°ticas (motores y sensores)</td>
                <td>2</td>
                <td>4</td>
                <td><span class="badge red">Cr√≠tico</span></td>
            </tr>
        </tbody>
    </table>

    <!-- LINK AL SITIO OFICIAL -->
    <div class="footer-link">
        <a href="https://www.buseshualpen.cl/" target="_blank">
            üåê Sitio oficial de Buses Hualp√©n
        </a>
    </div>

</div>

<script src="chart.js"></script>

</body>
</html>
